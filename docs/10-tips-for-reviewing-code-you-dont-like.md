# 审查你不喜欢的代码的 10 个技巧

> 原文：<https://developers.redhat.com/blog/2019/07/08/10-tips-for-reviewing-code-you-dont-like>

作为开源项目的经常贡献者(无论是在 Red Hat 内部还是外部)，我发现最常见的时间浪费之一是处理我提交的代码的代码审查，这些审查是负面的或阻碍性的，但本质上是主观的或争论性的。我经常在提交维护者不喜欢变更的项目时看到这种情况，不管是什么原因。在最好的情况下，这种代码审查策略会导致时间浪费在无意义的争论上；最糟糕的是，它积极地阻碍了项目中的贡献和多样性，并创造了一个充满敌意和精英主义的环境。

代码评审应该是客观和简洁的，并且应该尽可能地处理确定性。这不是政治或情感上的争论；这是一个技术问题，目标应该始终是向前推进并提升项目及其参与者。变更提交应该总是根据提交的优点进行评估，而不是根据提交者的个人观点。

## 代码评审策略

无论出于何种原因，当您(作为项目维护者)审查您不喜欢的提交时，请记住以下几个策略:

### 1.把你的反对意见换成一个问题

*   坏:“这个变化会让 XXX 不可能。”(这是夸张；真的*不可能吗*？)
*   好:“你的变化我们怎么做 XXX？”

### 2.避免夸张

简单地陈述你的担忧并提出问题来帮助你达到期望的结果。

*   不好:“这个变化会破坏性能。”
*   好:“看起来做 X 可能比现有的 Y 要慢；你有没有测量/收集数据来证明事实并非如此？”
*   更好(如果你有时间):“与此同时，我正在收集数据，试图验证 X 不比 y 慢。”
*   还好:“这个改动把这个单循环 O(n)变成了双嵌套循环 O(n)；这样不会影响性能吗？”

### 3.把挖苦的话留给自己

有些想法还是留给自己比较好。不能文明，就不要搞。

*   坏:“我觉得这种改变不好，会毁了一切。”
*   坏:“你确定软件工程是适合你的职业道路吗？”

### 4.积极参与

也许你对如何解决问题有不同的想法？如果你积极参与，你可能最终会发现一个比最初的选择更好的解决方案。

*   坏:“这个改的烂透了，我的版本更好。”
*   好:“我在这个位置 XXX 也有类似的变化:也许我们可以比较和/或结合想法。”
*   还好:“我也有类似的变化在进行，但我选择做 X 是因为 ZZZ 为什么选 Y？”

### 5.记住，不是每个人的经历都和你的一样

一个完全有能力的工程师可能会连续几年不知道一些你认为是常识的事实。陈述显而易见的事情是没问题的，只要你不是以高人一等的态度或对此嗤之以鼻。

*   坏:“你没看出来这明显不对吗？”
*   好:“这是不正确的，因为当 X 为 y 时会导致空指针异常。”

### 6.不要降低不明显的事物的复杂性

记住，对你来说显而易见的事情不一定对每个人都显而易见。建议替代方法并指出有用的例子可以帮助大家达成共识。

*   坏消息:“为什么不干脆从鼻子里出来？”
*   好:“也许可以去掉 gnozzle，这将简化这一部分(参见 XXX 的例子)。”

### 7.要尊重

有时，提交的内容不符合最低质量标准。这么说没问题，但是恭敬不需要额外花费什么。

*   坏:“这是一个愚蠢的人写的愚蠢的代码。”
*   好:“谢谢你的贡献。然而，目前的形式不能被接受；存在多个问题(如上所述)。”
*   也不错:“如上所述，这个提交有多个问题。也许我们可以后退一步，转而讨论用例？这可以帮助我们找到前进的道路。”

### 8.管理期望(和你的时间)

如果提交的内容太大，无法进行合理的审查，可以马上让提交者知道。继续前进。

*   坏:“我不合并这个，太大了。”
*   同样不好的是:忽视它，直到它消失。
*   好:“你能把这个分成更小的零钱吗？我没有太多的时间进行代码审查，而这一项太大/太复杂，无法一次审查完。”

### 9.说请

仅仅说“请”就能显示出你尊重提交者的时间，尤其是当你希望某些东西因格式或风格而有所不同时，这可能看起来是一个微小的变化。示例:

*   "你能把空白的改变分成另一个拉请求吗？"
*   "你能不能把这些变量定义对齐，这样更容易阅读？"

### 10.开始对话

如果在经历了这一切之后，你仍然不喜欢某样东西*，但是你不知道为什么*，你可能不得不忍受它。但也可以说，“我不喜欢这样，也不知道为什么，我们能谈谈吗？”这是一个合理的问题，尽管可能需要一点时间，但这通常是值得的，因为现在你有两个人都在学习(一个通过解释，一个通过倾听)，而不是两个互相对立的人。

即使是技术娴熟、经验丰富的工程师，也应该能说“我不明白我为什么不喜欢这样”；这不是邀请攻击评论者的立场，而是对知识的诚实追求。

## 摘要

避免夸张或夸夸其谈的断言，避免争论策略，避免精英主义或贬低性的语言，避免像“显然”和“你为什么不……”。使用清晰、事实性的陈述和支持性的语言，提出问题，推动事情向前发展。记住，同事和贡献者也是人，他们的时间和你的时间一样值得尊重。

*Last updated: July 15, 2019*