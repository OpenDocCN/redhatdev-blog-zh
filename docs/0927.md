# 算法！=程序和程序不是“一刀切”

> 原文:[https://developers . red hat . com/blog/2019/02/12/algorithms-vs-programs](https://developers.redhat.com/blog/2019/02/12/algorithms-vs-programs)

你可能已经被教导过，选择一个具有最佳渐近成本的算法将会产生最佳的性能。您可能会惊讶地发现，在当前的硬件上，情况并非总是如此。许多算法分析假设非常简单的成本，其中操作的顺序并不重要。假设存储器访问时间相同。然而，缓存命中(几个处理器时钟周期)和需要访问主内存的缓存未命中([几百个周期](https://www.akkadia.org/drepper/cpumemory.pdf))之间的差异是巨大的。

本系列文章是作者(威廉·科恩和本·伍德尔德)讨论的结果，他们认为在计算机科学和计算机工程中教授的算法效率的典型思想与当前在实际计算机系统中遇到的问题之间存在脱节。

## 介绍

实现排序的最佳方式是什么？如果你在算法和数据结构课上集中注意力，你可能会很快回答“ [Quicksort](https://en.wikipedia.org/wiki/Quicksort) ”。然而，正确的答案可能更复杂，取决于具体的细节。没有人会提倡使用快速排序算法对只包含两个条目的无序列表进行排序。如果需要的话，通过比较和条件交换对元素进行重新排序，可以更有效、更简单地做到这一点。只有当要排序的元素数量非常大时，快速排序算法的优势才会变得明显。然而，其他排序算法，如[合并排序](https://en.wikipedia.org/wiki/Merge_sort)可能优于快速排序算法，即使两者具有相同的平均复杂度 *O(n log n)* ，因为合并排序具有更好的实际性能。开发人员在选择算法和在程序中实现算法时可能会做出不正确的假设，这会对性能产生负面影响。

[Big- *O* 符号](https://en.wikipedia.org/wiki/Big_O_notation)经常被用来衡量算法的优劣，并作为一种工具来预测程序的一部分在程序实际运行的物理世界中将如何表现。然而，用于大 T4 分析的简单序列模型并不能准确地代表当前的计算机系统成本。现代计算机硬件可以重叠操作，并且单个存储器访问成本可以根据存储器访问模式而变化很大([一百倍或更多](https://akkadia.org/drepper/cpumemory.pdf))。高性能机器可以执行多元素、向量式操作，其吞吐量比单独执行同等的单个操作要高得多。抽象模型和物理硬件之间的差异可能会导致交付性能的显著差异。例如，遍历链表和数组中的元素都很复杂，但是在现代处理器硬件上，由于随机内存访问模式，遍历链表中的元素比遍历具有规则的、容易预测的内存访问模式的等价一维元素数组要慢得多。

Big- *O* 渐近算法分析展示了计算工作量如何与问题规模成比例增长。然而，这并不表示哪种算法对于特定的问题规模是最有效的。常数的缺乏使得在处理特定问题规模的算法之间进行比较变得困难。一个比另一个算法具有更差的大 T2 渐近性能的算法对于较小的问题可能具有更好的性能。假设高速缓存未命中花费数百个周期,“更差”算法更快的问题规模的范围可能惊人地大。诸如 [Coppersmith-Winograd 矩阵乘法算法](https://en.wikipedia.org/wiki/Coppersmith%E2%80%93Winograd_algorithm) *(O(n^2.375477))* 之类的算法理论上比矩阵乘法的简单实现 *(O(n^3))* 更有效，但是问题规模需要大到提供实际中不使用它们的优势。

那些在 big- *O* 分析中经常被忽略的常数对效率和功耗有重大影响。对于一台播放视频的电池供电平板电脑来说，他们可以在整个八小时的跨大西洋飞行中用视频娱乐自己，也可以在电池耗尽之前只看一部两小时的电影。在另一个极端，对于每年使用数百万美元电力的高性能计算机系统来说，电力可能是运行成本的重要部分，并且存在使这些成本最小化的巨大压力。

许多程序员试图使用并行处理来获得更快的性能。在最好的情况下，并行计算机的速度与系统中处理器的数量成正比。对于并行计算机系统来说，如果一个程序在多个处理器上运行不会比在单个处理器上运行产生性能改进，那么在多个处理器上运行这个程序就没有什么意义。如果不小心编写代码，很可能使程序在多个处理器上运行的开销最终会使程序的并行版本比基本串行版本慢。可以用自己喜欢的搜索引擎，找到很多“并行程序比顺序程序慢”的例子。

程序员更熟悉简单的编程模型，类似于用于 big- *O* 分析的模型，其中操作的顺序并不重要，并且操作具有相同的低成本。对于高性能计算机，这些假设不成立。运营的分组方式会影响成本，运营成本可能存在数量级的差异。

## 未来文章

我们将开始一系列文章，讨论一些高性能计算问题，如数据布局、任务粒度、负载平衡和争用。这些文章的目标是帮助消除一些可能基于传统简化程序模型的假设，并引导人们为现代计算机编写更有效的代码。

虽然这些主题通常被认为属于高性能计算(HPC)领域，但这些讨论是普遍适用的。每年，HPC 的特性都会渗透到更传统的环境中。例如，向量处理仅在 80 年代和 90 年代的超级计算机上出现，但现在几乎每台笔记本电脑、台式机和服务器计算机都支持向量处理，并且有软件库来使用这些功能。

*Last updated: March 26, 2019*